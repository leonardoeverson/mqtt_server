<%- include('header'); %>
<title>Perfil</title>
<div class="col-sm-10">

    <hr/>
    <h5>Dados de cadastro</h5>
    <hr>
    <div class="row col-sm-10">

        <form>
            <div class="form-group" id="form">
                <label for="exampleInputEmail1">Nome</label>
                <input type="text" id="nome" name="nome" class="form-control" id="exampleInputEmail1" aria-describedby="Nome do usuário" readonly value='<%= dados[0].nome %>'>
            </div>
            <div class="form-group">
                <label for="exampleInputEmail1">Email</label>
                <input type="email" id="email" name="email" class="form-control" id="exampleInputEmail1" aria-describedby="Email do usuário" readonly value='<%= dados[0].email %>'>
            </div>
            <button type="submit" id="enviar" class="btn btn-primary">Atualizar Dados</button>
            <button type="cancelar" id="cancelar" class="btn btn-danger" hidden>Cancelar</button>
        </form>

    </div>
    <h5 style="margin-top: 20px">Alterar Senha</h5>
    <hr>
    <div class="row col-sm-10" style="margin-top: 40px">
        <button type="button" id="senha" class="btn btn-primary">Atualizar Senha</button>
    </div>

</div>

<div class="modal" id="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Atualizar senha</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="exampleInputPassword1">Senha antiga</label>
                    <input type="password" name="senha_antiga" class="form-control" id="exampleInputPassword1">
                </div>
                <div class="form-group">
                    <label for="exampleInputPassword1">Digite a nova senha</label>
                    <input type="password" name="senha_nova_1" class="form-control" id="exampleInputPassword1">
                </div>
                <div class="form-group">
                    <label for="exampleInputPassword1">Redigite a nova senha</label>
                    <input type="password" name="senha_nova_2" class="form-control" id="exampleInputPassword1">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="btn_senha_" class="btn btn-primary">Salvar</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>
<div class="d-none d-xl-block col-xl-2 bd-toc">

</div>

<script>

    enviar.addEventListener('click', function (e) {
        if(!enviar.getAttribute('enviar')){
            e.preventDefault();
            this.innerHTML = "Salvar";
            this.setAttribute('enviar',true);
            nome.readOnly = false;
            email.readOnly = false;
            cancelar.hidden = false;
        }else{
            let xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    //document.getElementById("demo").innerHTML = this.responseText;
                }
            };
            xhttp.open("POST", "/dados/usuario/salvar?email="+email.value+"&nome="+nome.value, true);
            xhttp.send();
        }
    })

    cancelar.addEventListener('click', function(e){
        e.preventDefault();
        enviar.innerHTML = "Atualizar Dados";
        enviar.removeAttribute('enviar')
        nome.readOnly = true;
        email.readOnly = true;
        cancelar.hidden = true;
    });

    senha.addEventListener('click', function(e){
        $('#modal').modal('show');
    })
</script>

<%- include('footer'); %>